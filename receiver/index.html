<html>
<head>
</head>
<body>
  <cast-media-player id="player"></cast-media-player>
  <style>
    #player {
        --theme-hue: 210;
        --progress-color: rgb(0, 100, 255);
        --splash-image: url("background.svg");
    }
  </style>
  <script type="text/javascript" src="//www.gstatic.com/cast/sdk/libs/caf_receiver/v3/cast_receiver_framework.js">
  </script>
  <script>

const context = cast.framework.CastReceiverContext.getInstance()
const player = context.getPlayerManager()

player.setMessageInterceptor(
    cast.framework.messages.MessageType.MEDIA_STATUS,
    status => {
        console.log("The old status", JSON.stringify(status, null, 2))
        let range = player.getLiveSeekableRange()
        if (range) {
            console.log("We have a range!")
            if (status.media) {
                // twice the duration, just for tests
                status.media.duration = (range.end - range.start) * 2
            }
        }
        console.log("The NEW status", JSON.stringify(status, null, 2))
        return status;
    }
)

player.addEventListener(
    cast.framework.events.category.CORE,
    event => {
        console.debug(event);
    }
)

const playbackConfig = new cast.framework.PlaybackConfig();
playbackConfig.autoResumeDuration = 5
playbackConfig.autoResumeNumberOfSegments = 1

context.start({
    playbackConfig: playbackConfig
})

  </script>
</body>
</html>